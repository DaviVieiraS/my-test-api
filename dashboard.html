<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #007cba;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        .tab.active {
            border-bottom-color: #007cba;
            background: #f8f9fa;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        button {
            background: #007cba;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a87;
        }
        .btn-danger {
            background: #dc3545;
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-success:hover {
            background: #218838;
        }
        .user-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #fafafa;
        }
        .user-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }
        .user-name {
            font-weight: bold;
            font-size: 1.2em;
        }
        .user-plan {
            background: #007cba;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        .device-list {
            margin-top: 10px;
        }
        .device-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #007cba;
        }
        .status-online { border-left-color: #28a745; }
        .status-offline { border-left-color: #dc3545; }
        .status-maintenance { border-left-color: #ffc107; }
        .protocol-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }
        .protocol-active { background: #d4edda; color: #155724; }
        .protocol-inactive { background: #f8d7da; color: #721c24; }
        .protocol-pending { background: #fff3cd; color: #856404; }
        .search-box {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .links {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .links a {
            color: #007cba;
            text-decoration: none;
            margin: 0 15px;
        }
        .links a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä User Management Dashboard</h1>
            <p>Manage users, devices, status protocols, and user plans</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalUsers">0</div>
                <div>Total Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalDevices">0</div>
                <div>Total Devices</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="onlineDevices">0</div>
                <div>Online Devices</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeProtocols">0</div>
                <div>Active Protocols</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('users')">üë• Users</div>
            <div class="tab" onclick="showTab('devices')">üì± Devices</div>
            <div class="tab" onclick="showTab('protocols')">üîß Protocols</div>
            <div class="tab" onclick="showTab('plans')">üí≥ Plans</div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content active">
            <div class="form-group">
                <input type="text" class="search-box" placeholder="Search users..." onkeyup="searchUsers(this.value)">
            </div>
            <button onclick="showAddUserForm()">‚ûï Add New User</button>
            <div id="usersList"></div>
        </div>

        <!-- Devices Tab -->
        <div id="devices" class="tab-content">
            <div class="form-group">
                <input type="text" class="search-box" placeholder="Search devices..." onkeyup="searchDevices(this.value)">
            </div>
            <button onclick="showAddDeviceForm()">‚ûï Add New Device</button>
            <div id="devicesList"></div>
        </div>

        <!-- Protocols Tab -->
        <div id="protocols" class="tab-content">
            <div class="form-group">
                <input type="text" class="search-box" placeholder="Search protocols..." onkeyup="searchProtocols(this.value)">
            </div>
            <button onclick="showAddProtocolForm()">‚ûï Add New Protocol</button>
            <div id="protocolsList"></div>
        </div>

        <!-- Plans Tab -->
        <div id="plans" class="tab-content">
            <div class="form-group">
                <input type="text" class="search-box" placeholder="Search plans..." onkeyup="searchPlans(this.value)">
            </div>
            <button onclick="showAddPlanForm()">‚ûï Add New Plan</button>
            <div id="plansList"></div>
        </div>

        <div class="links">
            <a href="index.html">üè† Home</a>
            <a href="post-viewer.html">üì® POST Viewer</a>
            <a href="post-form.html">üìù Test Form</a>
        </div>
    </div>

    <script>
        // Data storage
        let users = JSON.parse(localStorage.getItem('users') || '[]');
        let devices = JSON.parse(localStorage.getItem('devices') || '[]');
        let protocols = JSON.parse(localStorage.getItem('protocols') || '[]');
        let plans = JSON.parse(localStorage.getItem('plans') || '[]');

        // Initialize with sample data if empty
        function initializeData() {
            if (users.length === 0) {
                users = [
                    {
                        id: 1,
                        name: "Davi Vieira",
                        email: "davi@example.com",
                        plan: "Premium",
                        joinDate: "2025-01-14",
                        status: "active"
                    },
                    {
                        id: 2,
                        name: "Maria Silva",
                        email: "maria@example.com",
                        plan: "Basic",
                        joinDate: "2025-01-10",
                        status: "active"
                    }
                ];
                localStorage.setItem('users', JSON.stringify(users));
            }

            if (devices.length === 0) {
                devices = [
                    {
                        id: 1,
                        deviceNumber: "DEV001",
                        userId: 1,
                        deviceName: "iPhone 15 Pro",
                        status: "online",
                        lastSeen: new Date().toISOString(),
                        protocol: "HTTPS"
                    },
                    {
                        id: 2,
                        deviceNumber: "DEV002",
                        userId: 1,
                        deviceName: "MacBook Pro",
                        status: "offline",
                        lastSeen: "2025-01-13T10:30:00Z",
                        protocol: "WebSocket"
                    },
                    {
                        id: 3,
                        deviceNumber: "DEV003",
                        userId: 2,
                        deviceName: "Samsung Galaxy S24",
                        status: "online",
                        lastSeen: new Date().toISOString(),
                        protocol: "MQTT"
                    }
                ];
                localStorage.setItem('devices', JSON.stringify(devices));
            }

            if (protocols.length === 0) {
                protocols = [
                    {
                        id: 1,
                        name: "HTTPS",
                        status: "active",
                        description: "Secure HTTP protocol",
                        port: 443
                    },
                    {
                        id: 2,
                        name: "WebSocket",
                        status: "active",
                        description: "Real-time communication",
                        port: 8080
                    },
                    {
                        id: 3,
                        name: "MQTT",
                        status: "maintenance",
                        description: "IoT messaging protocol",
                        port: 1883
                    }
                ];
                localStorage.setItem('protocols', JSON.stringify(protocols));
            }

            if (plans.length === 0) {
                plans = [
                    {
                        id: 1,
                        name: "Basic",
                        price: 9.99,
                        features: ["5 devices", "Basic support", "Standard protocols"],
                        maxDevices: 5
                    },
                    {
                        id: 2,
                        name: "Premium",
                        price: 19.99,
                        features: ["20 devices", "Priority support", "All protocols", "Analytics"],
                        maxDevices: 20
                    },
                    {
                        id: 3,
                        name: "Enterprise",
                        price: 49.99,
                        features: ["Unlimited devices", "24/7 support", "Custom protocols", "Advanced analytics"],
                        maxDevices: -1
                    }
                ];
                localStorage.setItem('plans', JSON.stringify(plans));
            }
        }

        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // Refresh data
            updateStats();
            if (tabName === 'users') displayUsers();
            else if (tabName === 'devices') displayDevices();
            else if (tabName === 'protocols') displayProtocols();
            else if (tabName === 'plans') displayPlans();
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalDevices').textContent = devices.length;
            document.getElementById('onlineDevices').textContent = devices.filter(d => d.status === 'online').length;
            document.getElementById('activeProtocols').textContent = protocols.filter(p => p.status === 'active').length;
        }

        // Display users
        function displayUsers() {
            const container = document.getElementById('usersList');
            container.innerHTML = users.map(user => {
                const userDevices = devices.filter(d => d.userId === user.id);
                const onlineDevices = userDevices.filter(d => d.status === 'online').length;
                
                return `
                    <div class="user-card">
                        <div class="user-header">
                            <div class="user-name">${user.name}</div>
                            <div class="user-plan">${user.plan}</div>
                        </div>
                        <div><strong>Email:</strong> ${user.email}</div>
                        <div><strong>Join Date:</strong> ${user.joinDate}</div>
                        <div><strong>Devices:</strong> ${onlineDevices}/${userDevices.length} online</div>
                        <div><strong>Status:</strong> ${user.status}</div>
                        <div class="device-list">
                            ${userDevices.map(device => `
                                <div class="device-item status-${device.status}">
                                    <strong>${device.deviceNumber}</strong> - ${device.deviceName}
                                    <span class="protocol-status protocol-${device.status}">${device.protocol}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="editUser(${user.id})">‚úèÔ∏è Edit</button>
                        <button class="btn-danger" onclick="deleteUser(${user.id})">üóëÔ∏è Delete</button>
                    </div>
                `;
            }).join('');
        }

        // Display devices
        function displayDevices() {
            const container = document.getElementById('devicesList');
            container.innerHTML = devices.map(device => {
                const user = users.find(u => u.id === device.userId);
                return `
                    <div class="user-card">
                        <div class="user-header">
                            <div class="user-name">${device.deviceNumber} - ${device.deviceName}</div>
                            <div class="user-plan">${device.status}</div>
                        </div>
                        <div><strong>User:</strong> ${user ? user.name : 'Unknown'}</div>
                        <div><strong>Protocol:</strong> ${device.protocol}</div>
                        <div><strong>Last Seen:</strong> ${new Date(device.lastSeen).toLocaleString()}</div>
                        <button onclick="editDevice(${device.id})">‚úèÔ∏è Edit</button>
                        <button class="btn-danger" onclick="deleteDevice(${device.id})">üóëÔ∏è Delete</button>
                    </div>
                `;
            }).join('');
        }

        // Display protocols
        function displayProtocols() {
            const container = document.getElementById('protocolsList');
            container.innerHTML = protocols.map(protocol => `
                <div class="user-card">
                    <div class="user-header">
                        <div class="user-name">${protocol.name}</div>
                        <div class="user-plan">${protocol.status}</div>
                    </div>
                    <div><strong>Description:</strong> ${protocol.description}</div>
                    <div><strong>Port:</strong> ${protocol.port}</div>
                    <button onclick="editProtocol(${protocol.id})">‚úèÔ∏è Edit</button>
                    <button class="btn-danger" onclick="deleteProtocol(${protocol.id})">üóëÔ∏è Delete</button>
                </div>
            `).join('');
        }

        // Display plans
        function displayPlans() {
            const container = document.getElementById('plansList');
            container.innerHTML = plans.map(plan => `
                <div class="user-card">
                    <div class="user-header">
                        <div class="user-name">${plan.name}</div>
                        <div class="user-plan">$${plan.price}/month</div>
                    </div>
                    <div><strong>Max Devices:</strong> ${plan.maxDevices === -1 ? 'Unlimited' : plan.maxDevices}</div>
                    <div><strong>Features:</strong></div>
                    <ul>
                        ${plan.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                    <button onclick="editPlan(${plan.id})">‚úèÔ∏è Edit</button>
                    <button class="btn-danger" onclick="deletePlan(${plan.id})">üóëÔ∏è Delete</button>
                </div>
            `).join('');
        }

        // Search functions
        function searchUsers(query) {
            // Implementation for user search
            console.log('Searching users:', query);
        }

        function searchDevices(query) {
            // Implementation for device search
            console.log('Searching devices:', query);
        }

        function searchProtocols(query) {
            // Implementation for protocol search
            console.log('Searching protocols:', query);
        }

        function searchPlans(query) {
            // Implementation for plan search
            console.log('Searching plans:', query);
        }

        // Form functions (simplified for now)
        function showAddUserForm() {
            const name = prompt('User name:');
            const email = prompt('Email:');
            if (name && email) {
                const newUser = {
                    id: Date.now(),
                    name: name,
                    email: email,
                    plan: 'Basic',
                    joinDate: new Date().toISOString().split('T')[0],
                    status: 'active'
                };
                users.push(newUser);
                localStorage.setItem('users', JSON.stringify(users));
                displayUsers();
                updateStats();
            }
        }

        function showAddDeviceForm() {
            const deviceNumber = prompt('Device Number:');
            const deviceName = prompt('Device Name:');
            const userId = prompt('User ID:');
            if (deviceNumber && deviceName && userId) {
                const newDevice = {
                    id: Date.now(),
                    deviceNumber: deviceNumber,
                    userId: parseInt(userId),
                    deviceName: deviceName,
                    status: 'online',
                    lastSeen: new Date().toISOString(),
                    protocol: 'HTTPS'
                };
                devices.push(newDevice);
                localStorage.setItem('devices', JSON.stringify(devices));
                displayDevices();
                updateStats();
            }
        }

        function showAddProtocolForm() {
            const name = prompt('Protocol Name:');
            const description = prompt('Description:');
            const port = prompt('Port:');
            if (name && description && port) {
                const newProtocol = {
                    id: Date.now(),
                    name: name,
                    status: 'active',
                    description: description,
                    port: parseInt(port)
                };
                protocols.push(newProtocol);
                localStorage.setItem('protocols', JSON.stringify(protocols));
                displayProtocols();
                updateStats();
            }
        }

        function showAddPlanForm() {
            const name = prompt('Plan Name:');
            const price = prompt('Price:');
            const maxDevices = prompt('Max Devices (or -1 for unlimited):');
            if (name && price && maxDevices) {
                const newPlan = {
                    id: Date.now(),
                    name: name,
                    price: parseFloat(price),
                    features: ['Basic features'],
                    maxDevices: parseInt(maxDevices)
                };
                plans.push(newPlan);
                localStorage.setItem('plans', JSON.stringify(plans));
                displayPlans();
                updateStats();
            }
        }

        // Edit/Delete functions (simplified)
        function editUser(id) {
            alert('Edit user functionality - implement as needed');
        }

        function deleteUser(id) {
            if (confirm('Are you sure you want to delete this user?')) {
                users = users.filter(u => u.id !== id);
                localStorage.setItem('users', JSON.stringify(users));
                displayUsers();
                updateStats();
            }
        }

        function editDevice(id) {
            alert('Edit device functionality - implement as needed');
        }

        function deleteDevice(id) {
            if (confirm('Are you sure you want to delete this device?')) {
                devices = devices.filter(d => d.id !== id);
                localStorage.setItem('devices', JSON.stringify(devices));
                displayDevices();
                updateStats();
            }
        }

        function editProtocol(id) {
            alert('Edit protocol functionality - implement as needed');
        }

        function deleteProtocol(id) {
            if (confirm('Are you sure you want to delete this protocol?')) {
                protocols = protocols.filter(p => p.id !== id);
                localStorage.setItem('protocols', JSON.stringify(protocols));
                displayProtocols();
                updateStats();
            }
        }

        function editPlan(id) {
            alert('Edit plan functionality - implement as needed');
        }

        function deletePlan(id) {
            if (confirm('Are you sure you want to delete this plan?')) {
                plans = plans.filter(p => p.id !== id);
                localStorage.setItem('plans', JSON.stringify(plans));
                displayPlans();
                updateStats();
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            updateStats();
            displayUsers();
        });
    </script>
</body>
</html>
